<ion-header>
  <ion-toolbar>
    <ion-title>{{journeyTitle}}</ion-title>
    <ion-button slot="end">
      <ion-back-button defaultHref="" icon="close"></ion-back-button>
    </ion-button>
  </ion-toolbar>
</ion-header>

<ion-content>

  <ion-card>
    <ion-card-header>
      <ion-toolbar>
        <ion-card-title>Details:
          <div *ngIf="!isEditMode; else titleInput">
            {{payment.title || 'No title'}}
          </div>
          <ng-template #titleInput>
            <ion-input disabled="{{!isEditMode}}" placeholder="{{payment.title}}"></ion-input>
          </ng-template>
        </ion-card-title>
        <ion-button slot="end" *ngIf="!isEditMode" on-click="toggleEditMode()">
          <ion-icon slot="icon-only" name="{{'create'}}"></ion-icon>
        </ion-button>
        <ion-button slot="end" *ngIf="isEditMode" on-click="toggleEditMode()">
          <ion-icon slot="icon-only" name="{{'arrow-back'}}"></ion-icon>
        </ion-button>
      </ion-toolbar>
    </ion-card-header>
    <ion-card-content>
      <ion-list>

        <ion-item>
          <ion-icon slot="start" name="person"></ion-icon>
          <ion-label>
            Payer
          </ion-label>
          <div *ngIf="!isEditMode; else payerDropdown">
            {{payment.payerID || 'No payer'}}
          </div>
          <ng-template #payerDropdown>
            <ion-select slot="end" placeholder="{{payment.payerID === undefined ? 'Select' : payment.payerID}}">
              <ion-select-option *ngFor="let item of people" value="{{item}}">{{item}}</ion-select-option>
            </ion-select>
          </ng-template>
        </ion-item>

        <ion-item>
          <ion-icon slot="start" name="cash-outline"></ion-icon>
          <ion-label>
            Value
          </ion-label>
          <div *ngIf="!isEditMode; else valueCurrencyInput">
            {{payment?.value + '' + payment?.currency || 'No value'}}
          </div>
          <ng-template #valueCurrencyInput>
            <ion-input class="ion-text-right" slot="end" type="number"
                       [(ngModel)]="payment.value">
            </ion-input>
          </ng-template>
        </ion-item>
        <ion-item *ngIf="isEditMode">
          <ion-icon slot="start" name="logo-euro"></ion-icon>
          <ion-label>
            Currency
          </ion-label>
          <ion-select slot="end" placeholder="{{payment.currency === undefined ? 'Select' : payment.currency}}">
            <ion-select-option *ngFor="let item of currencies" value="{{item}}">{{item}}</ion-select-option>
          </ion-select>
        </ion-item>

        <ion-item>
          <ion-icon slot="start" name="calendar-outline"></ion-icon>
          <ion-label>
            Payday
          </ion-label>
          <div *ngIf="!isEditMode; else dateInput">
            {{payment.payday.getDate() + '.' + payment.payday.getMonth() + '.' + payment.payday.getFullYear()}}
          </div>
          <ng-template #dateInput>
            <ion-datetime-button datetime="datetime"></ion-datetime-button>
            <ion-modal [keepContentsMounted]="true">
              <ng-template>
                <ion-datetime presentation="date" id="datetime"></ion-datetime>
              </ng-template>
            </ion-modal>
          </ng-template>
        </ion-item>

        <ion-item>
          <ion-icon slot="start" name="pricetags"></ion-icon>
          <ion-label>
            Category
          </ion-label>
          <div *ngIf="!isEditMode; else categoryDropdown">
            {{payment.category}}
          </div>
          <ng-template #categoryDropdown>
            <ion-select slot="end" placeholder="{{payment.category === undefined ? 'Select' : payment.category}}">
              <ion-select-option *ngFor="let item of categories" value="{{item}}">{{item}}</ion-select-option>
            </ion-select>
          </ng-template>
        </ion-item>

        <ion-item-group>
          <ion-item>
            <ion-label class="ion-text-center ion-align-self-center">
              <ion-icon name="people"></ion-icon>
              Involved
            </ion-label>
          </ion-item>
          <span *ngFor="let item of payment.involvedIDs">
              <ion-chip on-click="isEditMode && removeInvolved(item)">
                {{item}}
                <ion-icon color="danger" *ngIf="isEditMode" name="close-circle-outline"></ion-icon>
              </ion-chip>
            </span>
          <ion-fab-button *ngIf="isEditMode" color="success" size="small">
            <ion-icon name="add"></ion-icon>
          </ion-fab-button>
        </ion-item-group>

        <ion-button *ngIf="isEditMode && (payment.img === undefined)" fill="outline" expand="block">
          <ion-icon name="add"></ion-icon>
          <ion-icon name="camera-outline"></ion-icon>
        </ion-button>
        <ion-img *ngIf="!isEditMode"
                 src="https://www.stuttgarter-zeitung.de/media.media.5de4dbed-0458-4e9f-9c90-9164a07d9088.original1024.jpg"></ion-img>
      </ion-list>

    </ion-card-content>

  </ion-card>
</ion-content>

<ion-footer *ngIf="isEditMode"
            [translucent]="true">
  <ion-button color="success" shape="round" expand="full" (click)="save(); toggleEditMode();">
    <ion-icon slot="start" name="save-outline"></ion-icon>
    Save
  </ion-button>
</ion-footer>

<ion-footer [translucent]="true" collapse="fade">
  <ion-toolbar>
    <ion-buttons style="justify-content: space-evenly">
      <ion-back-button defaultHref="/"></ion-back-button>
      <ion-button routerLink="/" routerDirection="forward">
        <ion-icon slot="icon-only" name="home"></ion-icon>
      </ion-button>
      <ion-button routerLink="/notifications" routerDirection="forward">
        <ion-icon slot="icon-only" name="notifications"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-footer>
